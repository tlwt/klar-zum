<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Formular Ausf√ºller</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .content {
            padding: 30px;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4facfe;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .form-section {
            margin-bottom: 30px;
            padding: 25px;
            background: #f8f9ff;
            border-radius: 10px;
            border-left: 4px solid #4facfe;
        }
        
        .form-section h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.3rem;
        }
        
        .form-section .description {
            color: #666;
            margin-bottom: 20px;
            font-style: italic;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #555;
        }
        
        .form-group .field-description {
            font-size: 0.9em;
            color: #777;
            margin-bottom: 8px;
            line-height: 1.4;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }
        
        .pdf-selection {
            margin: 20px 0;
        }
        
        .pdf-checkbox {
            display: flex;
            align-items: flex-start;
            margin: 10px 0;
            padding: 20px;
            background: white;
            border-radius: 8px;
            border: 2px solid #e1e5e9;
            transition: all 0.3s;
        }
        
        .pdf-checkbox:hover {
            border-color: #4facfe;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .pdf-checkbox input[type="checkbox"] {
            margin-right: 15px;
            margin-top: 3px;
            transform: scale(1.2);
        }
        
        .pdf-info {
            flex: 1;
        }
        
        .pdf-info h4 {
            margin-bottom: 8px;
            color: #333;
            font-size: 1.1rem;
        }
        
        .pdf-info .pdf-path {
            font-size: 0.85em;
            color: #888;
            font-family: monospace;
            margin-bottom: 5px;
        }
        
        .pdf-info .pdf-fields {
            font-size: 0.9em;
            color: #666;
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 30px;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(79, 172, 254, 0.3);
        }
        
        .btn-secondary {
            background: #f8f9ff;
            color: #4facfe;
            border: 2px solid #4facfe;
        }
        
        .btn-secondary:hover {
            background: #4facfe;
            color: white;
        }
        
        .file-input {
            display: none;
        }
        
        .file-label {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 15px 30px;
            background: #f8f9ff;
            color: #4facfe;
            border: 2px solid #4facfe;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }
        
        .file-label:hover {
            background: #4facfe;
            color: white;
        }
        
        .status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            display: none;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .url-params {
            background: #e8f4f8;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #17a2b8;
        }
        
        .error-message {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>PDF Formular Ausf√ºller</h1>
            <p>Automatisches Ausf√ºllen von PDF-Formularen mit Feld-Erkennung</p>
        </div>
        
        <div class="content">
            <div id="loading" class="loading">
                <div class="loading-spinner"></div>
                <p>Lade PDF-Formulare und Konfiguration...</p>
            </div>
            
            <div id="mainContent" style="display: none;">
                <div id="urlParams" class="url-params" style="display: none;">
                    <h4>üîó URL-Parameter erkannt:</h4>
                    <div id="urlParamsContent"></div>
                </div>
                
                <div id="pdfSection" class="form-section">
                    <h3>üìÑ PDF-Formulare ausw√§hlen</h3>
                    <p class="description">W√§hlen Sie die PDF-Formulare aus, die Sie ausf√ºllen m√∂chten.</p>
                    <div id="pdfSelection" class="pdf-selection">
                        <!-- Wird dynamisch mit PDFs aus ./formulare gef√ºllt -->
                    </div>
                </div>
                
                <form id="dataForm">
                    <div id="formSections">
                        <!-- Wird dynamisch basierend auf PDF-Feldern und Konfiguration generiert -->
                    </div>
                </form>
                
                <div class="button-group">
                    <button type="button" class="btn btn-primary" onclick="generatePDFs()">
                        üìÑ PDFs generieren
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="saveData()">
                        üíæ Daten speichern
                    </button>
                    <label for="loadFile" class="file-label">
                        üìÅ Daten laden
                    </label>
                    <input type="file" id="loadFile" class="file-input" accept=".json" onchange="loadData(event)">
                    <button type="button" class="btn btn-secondary" onclick="downloadSampleConfig()">
                        ‚öôÔ∏è Beispiel-Config herunterladen
                    </button>
                </div>
                
                <div id="status" class="status"></div>
            </div>
            
            <div id="errorMessage" class="error-message" style="display: none;">
                <h4>‚ùå Fehler beim Laden</h4>
                <p>Die PDF-Formulare konnten nicht geladen werden. Stellen Sie sicher, dass:</p>
                <ul>
                    <li>Das Verzeichnis <code>./formulare/</code> existiert</li>
                    <li>PDF-Dateien im Verzeichnis vorhanden sind</li>
                    <li>Die Datei √ºber einen lokalen Server (nicht file://) geladen wird</li>
                </ul>
                <p><strong>Tipp:</strong> Verwenden Sie <code>python -m http.server</code> oder einen √§hnlichen lokalen Server.</p>
            </div>
        </div>
    </div>

    <script>
        let availablePDFs = [];
        let pdfFields = new Map(); // Map von PDF-Datei zu deren Feldern
        let fieldConfig = {}; // Konfiguration aus config.json
        let allFormFields = new Set(); // Alle gefundenen Formularfelder
        
        // Standard-Konfiguration f√ºr Felder
        const defaultFieldConfig = {
            // Wird dynamisch aus config.json geladen
        };

        // Beim Laden der Seite
        window.addEventListener('load', async function() {
            await initializeApp();
        });

        async function initializeApp() {
            try {
                // Konfiguration laden
                await loadFieldConfig();
                
                // PDFs aus ./formulare laden
                await loadPDFsFromDirectory();
                
                // Formular generieren
                generateForm();
                
                // URL-Parameter verarbeiten
                handleUrlParams();
                
                // Hauptinhalt anzeigen
                document.getElementById('loading').style.display = 'none';
                document.getElementById('mainContent').style.display = 'block';
                
            } catch (error) {
                console.error('Fehler beim Initialisieren:', error);
                showError();
            }
        }

        async function loadFieldConfig() {
            try {
                const response = await fetch('./config.json');
                if (response.ok) {
                    fieldConfig = await response.json();
                } else {
                    console.warn('config.json nicht gefunden, verwende Standard-Konfiguration');
                    fieldConfig = {};
                }
            } catch (error) {
                console.warn('Fehler beim Laden der Konfiguration:', error);
                fieldConfig = {};
            }
        }

        async function loadPDFsFromDirectory() {
            try {
                // Verzeichnis-Listing von Python HTTP Server abrufen
                const dirResponse = await fetch('./formulare/');
                if (!dirResponse.ok) {
                    throw new Error('Verzeichnis ./formulare/ nicht erreichbar');
                }
                
                const dirHTML = await dirResponse.text();
                
                // PDF-Dateinamen aus dem HTML extrahieren
                const pdfNames = extractPDFNamesFromListing(dirHTML);
                
                if (pdfNames.length === 0) {
                    throw new Error('Keine PDF-Dateien im Verzeichnis ./formulare/ gefunden');
                }
                
                console.log('Gefundene PDFs:', pdfNames);
                
                // Jede gefundene PDF-Datei laden
                for (const pdfName of pdfNames) {
                    try {
                        console.log(`Lade PDF: ${pdfName}`);
                        const response = await fetch(`./formulare/${encodeURIComponent(pdfName)}`);
                        if (response.ok) {
                            const arrayBuffer = await response.arrayBuffer();
                            const pdfDoc = await PDFLib.PDFDocument.load(arrayBuffer);
                            
                            // PDF-Felder extrahieren
                            const fields = await extractFieldsFromPDF(pdfDoc, pdfName);
                            
                            availablePDFs.push({
                                name: pdfName,
                                path: `./formulare/${pdfName}`,
                                document: pdfDoc,
                                fields: fields
                            });
                            
                            pdfFields.set(pdfName, fields);
                            
                            // Alle Felder zur Gesamtliste hinzuf√ºgen
                            fields.forEach(field => allFormFields.add(field));
                            
                            console.log(`PDF ${pdfName} erfolgreich geladen mit ${fields.length} Feldern`);
                        }
                    } catch (error) {
                        console.warn(`Fehler beim Laden von ${pdfName}:`, error);
                    }
                }
                
                if (availablePDFs.length === 0) {
                    throw new Error('Keine PDF-Formulare konnten geladen werden');
                }
                
                console.log(`Insgesamt ${availablePDFs.length} PDFs geladen`);
                
            } catch (error) {
                console.error('Fehler beim Laden der PDFs:', error);
                throw error;
            }
        }

        function extractPDFNamesFromListing(html) {
            const pdfNames = [];
            
            // Regex f√ºr Links zu PDF-Dateien im Python HTTP Server Listing
            const linkRegex = /<a href="([^"]+\.pdf)"/gi;
            let match;
            
            while ((match = linkRegex.exec(html)) !== null) {
                const fileName = decodeURIComponent(match[1]);
                pdfNames.push(fileName);
            }
            
            return pdfNames;
        }

        async function extractFieldsFromPDF(pdfDoc, pdfName) {
            const extractedFields = [];
            
            try {
                // Versuche zuerst echte PDF-Formularfelder zu extrahieren
                const form = pdfDoc.getForm();
                const fields = form.getFields();
                
                for (const field of fields) {
                    const fieldName = field.getName();
                    extractedFields.push(fieldName);
                }
                
                console.log(`PDF-Formularfelder in ${pdfName}:`, extractedFields);
                
            } catch (error) {
                console.log(`Keine Formularfelder in ${pdfName} gefunden:`, error);
            }
            
            // Falls keine Formularfelder gefunden wurden oder zus√§tzlich 
            // nach Text-Platzhaltern suchen basierend auf PDF-Namen
            if (extractedFields.length === 0) {
                console.log(`Verwende Standard-Felder f√ºr ${pdfName}`);
                
                // Basierend auf Ihren PDF-Namen intelligente Felder zuweisen
                if (pdfName.includes('Arbeitgeber') || pdfName.includes('EV')) {
                    extractedFields.push(
                        'firma', 'datum_formular', 'nachname', 'vorname', 'pk',
                        'strasse', 'plz', 'ort', 'persnr', 'email', 'telefon',
                        'datum_von', 'datum_bis', 'unterschrift_ort', 'datum_for'
                    );
                } else if (pdfName.includes('Anlage')) {
                    extractedFields.push(
                        'nachname', 'vorname', 'dienstgrad', 'persnr', 'pk',
                        'strasse', 'plz', 'ort', 'datum_formular', 'telefon',
                        'fax', 'email', 'datum_von', 'datum_bis'
                    );
                } else if (pdfName.includes('Einverst√§ndnis') || pdfName.includes('Ableistung')) {
                    extractedFields.push(
                        'nachname', 'vorname', 'dienstgrad', 'persnr', 'pk',
                        'strasse', 'plz', 'ort', 'telefon', 'fax', 'email',
                        'datum_von', 'datum_bis', 'dienststelle_name', 'dienststelle_ort'
                    );
                } else if (pdfName.includes('reisekosten')) {
                    extractedFields.push(
                        'nachname', 'vorname', 'datum_von', 'datum_bis',
                        'ort', 'zweck', 'betrag'
                    );
                } else {
                    // Standard-Felder f√ºr unbekannte PDFs
                    extractedFields.push(
                        'nachname', 'vorname', 'strasse', 'plz', 'ort',
                        'telefon', 'email', 'datum_formular'
                    );
                }
            }
            
            return [...new Set(extractedFields)]; // Duplikate entfernen
        }

        function generateForm() {
            // PDF-Auswahl generieren
            generatePDFSelection();
            
            // Formular-Felder generieren
            generateFormFields();
        }

        function generatePDFSelection() {
            const container = document.getElementById('pdfSelection');
            container.innerHTML = '';
            
            availablePDFs.forEach((pdf, index) => {
                const div = document.createElement('div');
                div.className = 'pdf-checkbox';
                div.innerHTML = `
                    <input type="checkbox" id="pdf_${index}" value="${pdf.name}">
                    <div class="pdf-info">
                        <h4>${pdf.name}</h4>
                        <div class="pdf-path">${pdf.path}</div>
                        <div class="pdf-fields">Felder: ${pdf.fields.length > 0 ? pdf.fields.join(', ') : 'Keine Felder erkannt'}</div>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function generateFormFields() {
            const container = document.getElementById('formSections');
            container.innerHTML = '';
            
            // Felder nach Gruppen organisieren
            const groupedFields = organizeFieldsByGroups();
            
            // Gruppen generieren
            for (const [groupName, fields] of Object.entries(groupedFields)) {
                const section = document.createElement('div');
                section.className = 'form-section';
                
                const groupConfig = fieldConfig.groups?.[groupName] || {};
                const groupTitle = groupConfig.title || groupName;
                const groupDescription = groupConfig.description || '';
                
                let sectionHTML = `
                    <h3>${groupTitle}</h3>
                    ${groupDescription ? `<div class="description">${groupDescription}</div>` : ''}
                    <div class="form-grid">
                `;
                
                fields.forEach(fieldName => {
                    sectionHTML += generateFormField(fieldName);
                });
                
                sectionHTML += '</div>';
                section.innerHTML = sectionHTML;
                container.appendChild(section);
            }
        }

        function organizeFieldsByGroups() {
            const grouped = {};
            const fieldsArray = Array.from(allFormFields);
            
            fieldsArray.forEach(fieldName => {
                const fieldConf = fieldConfig.fields?.[fieldName] || {};
                const group = fieldConf.group || 'Sonstige';
                
                if (!grouped[group]) {
                    grouped[group] = [];
                }
                grouped[group].push(fieldName);
            });
            
            return grouped;
        }

        function generateFormField(fieldName) {
            const fieldConf = fieldConfig.fields?.[fieldName] || {};
            const title = fieldConf.title || fieldName;
            const description = fieldConf.description || '';
            const type = fieldConf.type || (fieldName.includes('datum') ? 'date' : 'text');
            
            return `
                <div class="form-group">
                    <label for="${fieldName}">${title}</label>
                    ${description ? `<div class="field-description">${description}</div>` : ''}
                    <input type="${type}" id="${fieldName}" name="${fieldName}">
                </div>
            `;
        }

        function handleUrlParams() {
            const urlParams = new URLSearchParams(window.location.search);
            const paramsDiv = document.getElementById('urlParams');
            const paramsContent = document.getElementById('urlParamsContent');
            
            let hasParams = false;
            let content = '<ul>';
            
            for (const [key, value] of urlParams) {
                const element = document.getElementById(key);
                if (element) {
                    element.value = value;
                    content += `<li><strong>${key}:</strong> ${value}</li>`;
                    hasParams = true;
                }
            }
            
            // Standard-Werte f√ºr Datumsfelder setzen
            const today = new Date().toISOString().split('T')[0];
            ['datum_formular', 'datum_for'].forEach(fieldName => {
                const element = document.getElementById(fieldName);
                if (element && !element.value) {
                    element.value = today;
                }
            });
            
            if (hasParams) {
                content += '</ul>';
                paramsContent.innerHTML = content;
                paramsDiv.style.display = 'block';
            }
        }

        function showError() {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('errorMessage').style.display = 'block';
        }

        function showStatus(message, type = 'success') {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = `status ${type}`;
            status.style.display = 'block';
            
            setTimeout(() => {
                status.style.display = 'none';
            }, 5000);
        }

        function getFormData() {
            const form = document.getElementById('dataForm');
            const formData = new FormData(form);
            const data = {};
            
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }
            
            return data;
        }

        function saveData() {
            const data = getFormData();
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `formular-daten-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            showStatus('Daten erfolgreich gespeichert!');
        }

        function loadData(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    // Formular mit geladenen Daten f√ºllen
                    for (const [key, value] of Object.entries(data)) {
                        const element = document.getElementById(key);
                        if (element) {
                            element.value = value;
                        }
                    }
                    
                    showStatus('Daten erfolgreich geladen!');
                } catch (error) {
                    showStatus('Fehler beim Laden der Daten: ' + error.message, 'error');
                }
            };
            reader.readAsText(file);
        }

        async function generatePDFs() {
            const data = getFormData();
            const selectedPDFs = [];
            
            // Pr√ºfen welche PDFs ausgew√§hlt sind
            document.querySelectorAll('input[type="checkbox"]:checked').forEach(checkbox => {
                const pdfName = checkbox.value;
                const pdf = availablePDFs.find(p => p.name === pdfName);
                if (pdf) {
                    selectedPDFs.push(pdf);
                }
            });
            
            if (selectedPDFs.length === 0) {
                showStatus('Bitte w√§hlen Sie mindestens ein PDF-Formular aus.', 'error');
                return;
            }
            
            try {
                for (const pdf of selectedPDFs) {
                    await fillAndDownloadPDF(pdf, data);
                }
                
                showStatus(`${selectedPDFs.length} PDF(s) erfolgreich generiert!`);
                
            } catch (error) {
                showStatus('Fehler bei der PDF-Generierung: ' + error.message, 'error');
            }
        }

        async function fillAndDownloadPDF(pdf, data) {
            // Kopie des PDF-Dokuments erstellen
            const pdfDoc = await PDFLib.PDFDocument.load(await pdf.document.save());
            const form = pdfDoc.getForm();
            
            // Felder ausf√ºllen
            pdf.fields.forEach(fieldName => {
                const value = data[fieldName];
                if (value) {
                    try {
                        const field = form.getField(fieldName);
                        if (field) {
                            field.setText(value);
                        }
                    } catch (error) {
                        console.warn(`Feld ${fieldName} konnte nicht ausgef√ºllt werden:`, error);
                    }
                }
            });
            
            // PDF speichern und herunterladen
            const pdfBytes = await pdfDoc.save();
            const blob = new Blob([pdfBytes], { type: 'application/pdf' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `ausgefuellt-${pdf.name}`;
            link.click();
        }

        function downloadSampleConfig() {
            const sampleConfig = {
                "groups": {
                    "personal": {
                        "title": "üë§ Pers√∂nliche Daten",
                        "description": "Grundlegende Personalinformationen"
                    },
                    "contact": {
                        "title": "üè† Kontaktdaten", 
                        "description": "Ihre aktuellen Kontaktinformationen"
                    },
                    "service": {
                        "title": "üìÖ Dienstleistung",
                        "description": "Informationen zur Dienstleistung"
                    },
                    "employer": {
                        "title": "üè¢ Arbeitgeber",
                        "description": "Informationen zum Arbeitgeber"
                    },
                    "military": {
                        "title": "üéñÔ∏è Milit√§rische Daten",
                        "description": "Dienstgrad und milit√§rische Kennungen"
                    },
                    "location": {
                        "title": "üéØ Dienststelle",
                        "description": "Ort und Details der Dienstleistung"
                    }
                },
                "fields": {
                    "nachname": {
                        "title": "Nachname",
                        "description": "Ihr Familienname wie im Ausweis",
                        "group": "personal",
                        "type": "text"
                    },
                    "vorname": {
                        "title": "Vorname", 
                        "description": "Ihr Vorname wie im Ausweis",
                        "group": "personal",
                        "type": "text"
                    },
                    "dienstgrad": {
                        "title": "Dienstgrad der Reserve",
                        "description": "Ihr aktueller Dienstgrad",
                        "group": "military",
                        "type": "text"
                    },
                    "pk": {
                        "title": "Personenkennziffer",
                        "description": "12-stellige Personenkennziffer der Bundeswehr",
                        "group": "military",
                        "type": "text"
                    },
                    "persnr": {
                        "title": "Personalnummer",
                        "description": "Ihre milit√§rische Personalnummer",
                        "group": "military",
                        "type": "text"
                    },
                    "strasse": {
                        "title": "Stra√üe, Hausnummer",
                        "description": "Vollst√§ndige Stra√üenadresse", 
                        "group": "contact",
                        "type": "text"
                    },
                    "plz": {
                        "title": "Postleitzahl",
                        "description": "5-stellige deutsche PLZ",
                        "group": "contact", 
                        "type": "text"
                    },
                    "ort": {
                        "title": "Wohnort",
                        "description": "Ihr Wohnort",
                        "group": "contact",
                        "type": "text"
                    },
                    "email": {
                        "title": "E-Mail-Adresse",
                        "description": "Ihre E-Mail-Adresse",
                        "group": "contact",
                        "type": "email"
                    },
                    "telefon": {
                        "title": "Telefonnummer", 
                        "description": "Ihre Telefonnummer",
                        "group": "contact",
                        "type": "tel"
                    },
                    "fax": {
                        "title": "Fax",
                        "description": "Faxnummer (optional)",
                        "group": "contact",
                        "type": "tel"
                    },
                    "datum_von": {
                        "title": "Dienstleistung von",
                        "description": "Beginn der Dienstleistung",
                        "group": "service",
                        "type": "date"
                    },
                    "datum_bis": {
                        "title": "Dienstleistung bis", 
                        "description": "Ende der Dienstleistung",
                        "group": "service",
                        "type": "date"
                    },
                    "datum_formular": {
                        "title": "Datum Formular",
                        "description": "Datum der Formularerstellung",
                        "group": "service",
                        "type": "date"
                    },
                    "datum_for": {
                        "title": "Datum f√ºr Unterschrift",
                        "description": "Datum f√ºr die Unterschrift",
                        "group": "service",
                        "type": "date"
                    },
                    "firma": {
                        "title": "Firma/Unternehmen",
                        "description": "Name des Arbeitgebers",
                        "group": "employer",
                        "type": "text"
                    },
                    "unterschrift_ort": {
                        "title": "Unterschrift Ort",
                        "description": "Ort f√ºr die Unterschrift des Arbeitgebers",
                        "group": "employer",
                        "type": "text"
                    },
                    "dienststelle_name": {
                        "title": "Dienstleistungsdienststelle",
                        "description": "Name der Dienststelle",
                        "group": "location",
                        "type": "text"
                    },
                    "dienststelle_ort": {
                        "title": "Standort der Dienststelle",
                        "description": "Ort der Dienststelle",
                        "group": "location",
                        "type": "text"
                    },
                    "zweck": {
                        "title": "Zweck der Reise",
                        "description": "Grund f√ºr die Dienstreise",
                        "group": "service",
                        "type": "text"
                    },
                    "betrag": {
                        "title": "Betrag",
                        "description": "Reisekosten in Euro",
                        "group": "service",
                        "type": "text"
                    }
                }
            };
            
            const configStr = JSON.stringify(sampleConfig, null, 2);
            const blob = new Blob([configStr], {type: 'application/json'});
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'config.json';
            link.click();
            
            showStatus('Beispiel-Konfiguration heruntergeladen!');
        }
    </script>
</body>
</html>